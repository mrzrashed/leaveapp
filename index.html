<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡¶®‡ßà‡¶Æ‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶´‡¶∞‡¶Æ</title>
  <!-- Noto Sans Bengali ‡¶´‡¶®‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      /* ‡¶´‡¶®‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã */
      font-family: 'Noto Sans Bengali', sans-serif;
      background-color: #f5f7fa;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      max-width: 800px;
      width: 100%;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    h2 {
      text-align: center;
      margin-bottom: 25px;
      color: #333;
    }
    label {
      display: block;
      margin-top: 12px;
      font-weight: bold;
      color: #555;
    }
    input, select, textarea, button {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 15px;
      box-sizing: border-box; /* ÏùºÍ¥ÄÎêú ÏÇ¨Ïù¥Ïßï Î≥¥Ïû• */
      font-family: 'Noto Sans Bengali', sans-serif;
    }
    input[type="date"] {
      padding: 8px; /* ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶á‡¶®‡¶™‡ßÅ‡¶ü‡ßá‡¶∞ ‡¶™‡ßç‡¶Ø‡¶æ‡¶°‡¶ø‡¶Ç ‡¶†‡¶ø‡¶ï ‡¶ï‡¶∞‡¶æ */
    }
    button {
      margin-top: 25px;
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #0056b3;
    }
    .print-btns {
      display: flex;
      gap: 10px;
      /* ‡¶¨‡¶æ‡¶ü‡¶® ‡¶è‡¶ï‡¶ü‡¶ø ‡¶π‡¶≤‡ßá ‡¶è‡¶ü‡¶ø ‡¶∏‡ßá‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá */
      justify-content: center;
    }
    .print-btns button {
        /* ‡¶¨‡¶æ‡¶ü‡¶® ‡¶è‡¶ï‡¶ü‡¶ø ‡¶π‡¶≤‡ßá ‡¶Ø‡ßá‡¶® ‡¶™‡ßÅ‡¶∞‡ßã ‡¶ú‡¶æ‡ßü‡¶ó‡¶æ ‡¶®‡¶æ ‡¶®‡ßá‡ßü */
        max-width: 200px; 
    }
    #schoolList {
      border: 1px solid #ccc;
      border-top: none;
      border-radius: 0 0 6px 6px;
      max-height: 150px;
      overflow-y: auto;
      display: none;
      background: #fff;
      position: absolute;
      width: 100%;
      max-width: calc(800px - 60px); /* ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶á‡¶®‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡ßç‡¶Ø‡¶æ‡¶°‡¶ø‡¶Ç ‡¶¨‡¶æ‡¶¶ ‡¶¶‡¶ø‡ßü‡ßá */
      z-index: 10;
    }
    .school-item {
      padding: 8px 10px;
      cursor: pointer;
    }
    .school-item:hover {
      background-color: #e8f0fe;
    }
    /* ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™‡¶ï‡ßá ‡¶∞‡¶ø‡¶≤‡ßá‡¶ü‡¶ø‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶§‡ßá ‡¶°‡ßç‡¶∞‡¶™‡¶°‡¶æ‡¶â‡¶® ‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡¶ú‡¶ø‡¶∂‡¶® ‡¶π‡ßü */
    .input-group {
        position: relative;
    }

    /* --- ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡ßç‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø CSS --- */
    .modal-overlay {
      display: none; /* ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü‡¶≠‡¶æ‡¶¨‡ßá ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã ‡¶•‡¶æ‡¶ï‡¶¨‡ßá */
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.4);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background-color: #ffffff;
      margin: auto;
      padding: 25px 30px;
      border: 1px solid #888;
      width: 90%;
      max-width: 400px;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      text-align: center;
    }
    .modal-content p {
      font-size: 16px;
      margin-bottom: 20px;
    }
    .modal-close-btn {
      background-color: #007bff;
      color: white;
      padding: 8px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 15px;
    }
    .modal-close-btn:hover {
      background-color: #0056b3;
    }
    /* --- CSS ‡¶∂‡ßá‡¶∑ --- */

    /* ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    @media print {
      @page {
        margin: 0.8in; /* ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶® */
      }
      body {
        background-color: #fff;
      }
      body * {
        visibility: hidden;
      }
      .container {
        box-shadow: none;
        border: none;
        padding: 0;
        margin: 0;
      }
      #printArea, #printArea * {
        visibility: visible;
      }
      #printArea {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        font-size: 14px !important;
        margin: 0;
        padding: 0;
      }
      #printArea p.date-line {
        text-align: left !important;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>‡¶®‡ßà‡¶Æ‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶®‡¶™‡¶§‡ßç‡¶∞</h2>

    <!-- ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶á‡¶®‡¶™‡ßÅ‡¶ü‡¶ï‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™‡ßá ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡¶≤‡ßã -->
    <div class="input-group">
        <label for="schoolSearch">‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ:</label>
        <input type="text" id="schoolSearch" placeholder="‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßá ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶ï‡¶∞‡ßÅ‡¶®...">
        <div id="schoolList"></div>
    </div>

    <label for="name">‡¶Ü‡¶¨‡ßá‡¶¶‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ:</label>
    <input type="text" id="name" placeholder="‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">

    <label for="designation">‡¶™‡¶¶‡¶¨‡¶ø:</label>
    <input type="text" id="designation" value="‡¶∏‡¶π‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï">

    <label for="startDate">‡¶õ‡ßÅ‡¶ü‡¶ø ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</label>
    <input type="date" id="startDate">

    <label for="endDate">‡¶õ‡ßÅ‡¶ü‡¶ø ‡¶∂‡ßá‡¶∑‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</label>
    <input type="date" id="endDate">

    <label for="days">‡¶Æ‡ßã‡¶ü ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ:</label>
    <input type="number" id="days" readonly style="background-color: #eee;">

    <label for="reason">‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£:</label>
    <textarea id="reason" rows="3" placeholder="‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® (‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶∞‡¶æ‡¶ñ‡¶≤‡ßá '‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§ ‡¶ì ‡¶™‡¶æ‡¶∞‡¶ø‡¶¨‡¶æ‡¶∞‡¶ø‡¶ï' ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá)"></textarea>

    <label for="address">‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ:</label>
    <input type="text" id="address" value="‡¶¨‡¶¶‡¶∞‡¶ó‡¶û‡ßç‡¶ú, ‡¶∞‡¶Ç‡¶™‡ßÅ‡¶∞">

    <!-- ‡¶®‡¶§‡ßÅ‡¶® ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã -->
    <label for="previousLeave">‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶≠‡ßã‡¶ó‡¶ï‡ßÉ‡¶§ ‡¶õ‡ßÅ‡¶ü‡¶ø (‡¶¶‡¶ø‡¶®):</label>
    <!-- type="number" ‡¶ï‡ßá "text" ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã ‡¶è‡¶¨‡¶Ç inputmode="numeric" ‡¶ì oninput ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã -->
    <input type="text" id="previousLeave" inputmode="numeric" oninput="sanitizeNumericInput(this)" placeholder="‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® (‡¶Ø‡ßá‡¶Æ‡¶®: ‡ßß‡ß® ‡¶¨‡¶æ 12)">

    <button onclick="generatePreview()">‡¶´‡¶∞‡¶Æ ‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>

    <div id="preview" style="margin-top:30px; border-top:1px solid #eee; padding-top:20px;"></div>
    
    <div class="print-btns" id="printButtons" style="display:none; margin-top:20px;">
      <button onclick="printOnlyPreview()">üñ®Ô∏è ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
      <!-- ‡¶™‡¶ø‡¶°‡¶ø‡¶è‡¶´ ‡¶¨‡¶æ‡¶ü‡¶®‡¶ü‡¶ø ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá -->
    </div>
  </div>

  <!-- --- ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡ßç‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø HTML --- -->
  <div id="customAlert" class="modal-overlay">
    <div class="modal-content">
      <p id="modalMessage">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡ßç‡¶ü ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá</p>
      <button id="modalCloseBtn" class="modal-close-btn">‡¶†‡¶ø‡¶ï ‡¶Ü‡¶õ‡ßá</button>
    </div>
  </div>
  <!-- --- HTML ‡¶∂‡ßá‡¶∑ --- -->

  <!-- html2pdf.js ‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá -->
  
  <script>
    /* --- ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡ßç‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü --- */
    const modal = document.getElementById('customAlert');
    const modalMessage = document.getElementById('modalMessage');
    const modalCloseBtn = document.getElementById('modalCloseBtn');

    function showAlert(message) {
      modalMessage.textContent = message;
      modal.style.display = 'flex';
    }

    modalCloseBtn.onclick = function() {
      modal.style.display = 'none';
    }
    // ‡¶Æ‡¶°‡¶æ‡¶≤‡ßá‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶≤‡ßá ‡¶¨‡¶®‡ßç‡¶ß ‡¶π‡¶¨‡ßá
    window.onclick = function(event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    }
    /* --- ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡ßç‡¶ü ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶∂‡ßá‡¶∑ --- */


    /* --- ‡¶∏‡ßç‡¶ï‡ßÅ‡¶≤ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü --- */
    const schools = [
        "‡¶Æ‡¶æ‡¶®‡¶∏‡¶ø‡¶Ç‡¶π‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º", 
        "‡¶™‡¶æ‡¶∞‡¶¨‡¶ø‡¶∑‡ßç‡¶£‡ßÅ‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º", 
        "‡¶ò‡ßÉ‡¶≤‡¶æ‡¶á ‡¶ï‡ßÅ‡¶ü‡¶ø‡¶∞‡¶™‡¶æ‡¶°‡¶º‡¶æ ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º", 
        "‡¶¨‡¶ñ‡¶∂‡ßÄ‡¶ó‡¶û‡ßç‡¶ú ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º",
        "‡¶ï‡ßÅ‡¶§‡ßÅ‡¶¨‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º",
        "‡¶∞‡¶æ‡¶ß‡¶æ‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º"
    ];

    const schoolSearch = document.getElementById('schoolSearch');
    const schoolList = document.getElementById('schoolList');

    function showSchools(list) {
      schoolList.innerHTML = '';
      if (list.length === 0) {
        schoolList.style.display = 'none';
        return;
      }
      list.forEach(school => {
        const div = document.createElement('div');
        div.className = 'school-item';
        div.textContent = school;
        div.onclick = () => {
          schoolSearch.value = school;
          schoolList.style.display = 'none';
        };
        schoolList.appendChild(div);
      });
      schoolList.style.display = 'block';
    }

    schoolSearch.addEventListener('input', () => {
      const keyword = schoolSearch.value.toLowerCase();
      const filtered = schools.filter(s => s.toLowerCase().includes(keyword));
      showSchools(filtered);
    });
    
    // ‡¶°‡ßç‡¶∞‡¶™‡¶°‡¶æ‡¶â‡¶®‡ßá‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶≤‡ßá ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
    document.addEventListener('click', (e) => {
      // schoolSearch ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶¨‡¶æ schoolList-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶®‡¶æ ‡¶π‡¶≤‡ßá ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶π‡¶æ‡¶á‡¶° ‡¶ï‡¶∞‡ßã
      if (e.target.id !== 'schoolSearch' && !schoolList.contains(e.target)) {
        schoolList.style.display = 'none';
      }
    });

    /* --- ‡¶¶‡¶ø‡¶® ‡¶ó‡¶£‡¶®‡¶æ‡¶∞ ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü --- */
    const startDateInput = document.getElementById('startDate');
    const endDateInput = document.getElementById('endDate');
    const daysInput = document.getElementById('days');

    function calculateDays() {
      const start = new Date(startDateInput.value);
      const end = new Date(endDateInput.value);

      if (startDateInput.value && endDateInput.value && end < start) {
          showAlert("‡¶∂‡ßá‡¶∑‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶®‡¶æ‡•§");
          endDateInput.value = ''; // ‡¶∂‡ßá‡¶∑ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡¶®
          daysInput.value = '';
          return;
      }

      if (!isNaN(start.getTime()) && !isNaN(end.getTime()) && end >= start) {
        const diffTime = Math.abs(end - start);
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
        daysInput.value = diffDays;
      } else {
        daysInput.value = '';
      }
    }

    startDateInput.addEventListener('change', calculateDays);
    endDateInput.addEventListener('change', calculateDays);

    /* --- ‡¶®‡¶§‡ßÅ‡¶®: ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶´‡¶ø‡¶≤‡ßç‡¶°‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶¨‡¶æ ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶∞‡¶æ‡¶ñ‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® --- */
    function sanitizeNumericInput(inputElement) {
      // ‡¶è‡¶á ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡¶ü‡¶ø ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡ß¶-‡ßØ ‡¶è‡¶¨‡¶Ç ‡ß¶-‡ßØ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶á‡¶®‡¶™‡ßÅ‡¶ü‡ßá ‡¶∞‡¶æ‡¶ñ‡¶¨‡ßá, ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶∏‡¶¨ ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶¶‡ßá‡¶¨‡ßá
      let value = inputElement.value;
      let sanitizedValue = value.replace(/[^‡ß¶-‡ßØ0-9]/g, ''); // ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶¨‡¶æ ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø ‡¶Ö‡¶ô‡ßç‡¶ï ‡¶∞‡¶æ‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø Regex
      inputElement.value = sanitizedValue;
    }

    /* --- ‡¶®‡¶§‡ßÅ‡¶®: ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ï‡ßá ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡ßü ‡¶∞‡ßÇ‡¶™‡¶æ‡¶®‡ßç‡¶§‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® --- */
    function convertBanglaToNumeric(str) {
      if (!str) return '';
      const banglaNumerals = ['‡ß¶', '‡ßß', '‡ß®', '‡ß©', '‡ß™', '‡ß´', '‡ß¨', '‡ß≠', '‡ßÆ', '‡ßØ'];
      let numericStr = '';
      for (let i = 0; i < str.length; i++) {
        const char = str[i];
        const index = banglaNumerals.indexOf(char);
        if (index !== -1) {
          numericStr += index; // ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶™‡ßá‡¶≤‡ßá ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßã
        } else if (char >= '0' && char <= '9') {
          numericStr += char; // ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø ‡¶™‡ßá‡¶≤‡ßá ‡¶∏‡ßá‡¶ü‡¶æ‡¶á ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßã
        }
        // ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶®‡ßã ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞ (‡¶Ø‡¶¶‡¶ø‡¶ì ‡¶∏‡ßç‡¶Ø‡¶æ‡¶®‡¶ø‡¶ü‡¶æ‡¶á‡¶ú ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá) ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶¨‡¶æ‡¶¶ ‡¶™‡ßú‡¶¨‡ßá
      }
      return numericStr;
    }


    /* --- ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡¶ø‡¶Ç ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® --- */
    function formatDateBangla(dateStr) {
      if (!dateStr) return '';
      const months = ["‡¶ú‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø", "‡¶´‡ßá‡¶¨‡ßç‡¶∞‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø", "‡¶Æ‡¶æ‡¶∞‡ßç‡¶ö", "‡¶è‡¶™‡ßç‡¶∞‡¶ø‡¶≤", "‡¶Æ‡ßá", "‡¶ú‡ßÅ‡¶®", "‡¶ú‡ßÅ‡¶≤‡¶æ‡¶á", "‡¶Ü‡¶ó‡¶∏‡ßç‡¶ü", "‡¶∏‡ßá‡¶™‡ßç‡¶ü‡ßá‡¶Æ‡ßç‡¶¨‡¶∞", "‡¶Ö‡¶ï‡ßç‡¶ü‡ßã‡¶¨‡¶∞", "‡¶®‡¶≠‡ßá‡¶Æ‡ßç‡¶¨‡¶∞", "‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞"];
      const date = new Date(dateStr);
      const day = date.getDate().toString().replace(/[0-9]/g, d => '‡ß¶‡ßß‡ß®‡ß©‡ß™‡ß´‡ß¨‡ß≠‡ßÆ‡ßØ'[d]);
      const year = date.getFullYear().toString().replace(/[0-9]/g, d => '‡ß¶‡ßß‡ß®‡ß©‡ß™‡ß´‡ß¨‡ß≠‡ßÆ‡ßØ'[d]);
      return `${day} ${months[date.getMonth()]} ${year}`;
    }

    function numberToBangla(num) {
        if (num === null || num === undefined || num === '') return '';
      return num.toString().replace(/[0-9]/g, d => '‡ß¶‡ßß‡ß®‡ß©‡ß™‡ß´‡ß¨‡ß≠‡ßÆ‡ßØ'[d]);
    }

    /* --- ‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® --- */
    function generatePreview() {
      const school = schoolSearch.value;
      const name = document.getElementById('name').value;
      const designation = document.getElementById('designation').value;
      const startDateRaw = document.getElementById('startDate').value;
      const endDateRaw = document.getElementById('endDate').value;
      const daysRaw = document.getElementById('days').value;
      const reason = document.getElementById('reason').value;
      const address = document.getElementById('address').value;
      
      // --- ‡¶®‡¶§‡ßÅ‡¶®: ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶®‡ßá‡¶ì‡ßü‡¶æ ---
      const previousLeaveRaw = document.getElementById('previousLeave').value;

      // ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶ì ‡¶¶‡¶ø‡¶®‡¶ï‡ßá ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶ï‡¶∞‡¶æ
      const startDate = formatDateBangla(startDateRaw);
      const endDate = formatDateBangla(endDateRaw);
      const days = numberToBangla(daysRaw);

      // --- ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶® ---
      const nonBengaliRegex = /[a-zA-Z]/;
      if (nonBengaliRegex.test(school) ||
          nonBengaliRegex.test(name) ||
          nonBengaliRegex.test(designation) ||
          nonBengaliRegex.test(reason) ||
          nonBengaliRegex.test(address)) {
          
          showAlert('‡¶´‡¶∞‡ßç‡¶Æ‡ßá‡¶∞ ‡¶∏‡¶ï‡¶≤ ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶≤‡¶ø‡¶ñ‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§ ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ‡•§');
          return;
      }
      
      // --- ‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶® (‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶∏‡¶π) ---
      if (!school || !name || !designation || !startDateRaw || !endDateRaw || !address || previousLeaveRaw === '') {
        showAlert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶∏‡¶ï‡¶≤ ‡¶Ü‡¶¨‡¶∂‡ßç‡¶Ø‡¶ï ‡¶´‡¶ø‡¶≤‡ßç‡¶° (‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ, ‡¶Ü‡¶¨‡ßá‡¶¶‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ, ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ, ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ, ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶õ‡ßÅ‡¶ü‡¶ø) ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
        return;
      }

      // --- ‡¶®‡¶§‡ßÅ‡¶®: ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ---
      const totalCasualLeave = 20;
      
      // --- ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§: ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ï‡ßá ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø‡¶§‡ßá ‡¶∞‡ßÇ‡¶™‡¶æ‡¶®‡ßç‡¶§‡¶∞, ‡¶§‡¶æ‡¶∞‡¶™‡¶∞ parseInt ---
      const previousLeaveNumeric = convertBanglaToNumeric(previousLeaveRaw);
      const previousLeave = parseInt(previousLeaveNumeric); // parseInt ‡¶è‡¶ñ‡¶® ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶™‡¶æ‡¶¨‡ßá

      if (isNaN(previousLeave) || previousLeave < 0 || previousLeave > 20) {
          showAlert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶≠‡ßã‡¶ó‡¶ï‡ßÉ‡¶§ ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® (‡ß¶ ‡¶•‡ßá‡¶ï‡ßá ‡ß®‡ß¶ ‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá)‡•§');
          return;
      }
      
      const remainingLeave = totalCasualLeave - previousLeave;
      
      // ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ï‡ßá ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡ßü ‡¶∞‡ßÇ‡¶™‡¶æ‡¶®‡ßç‡¶§‡¶∞
      const previousLeaveBn = numberToBangla(previousLeave);
      const remainingLeaveBn = numberToBangla(remainingLeave);

      // ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ ‡¶≤‡¶æ‡¶á‡¶®
      const leaveSummary = `<p style="font-weight: bold; margin-top: 15px;">‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶≠‡ßã‡¶ó‡¶ï‡ßÉ‡¶§ ‡¶õ‡ßÅ‡¶ü‡¶ø ${previousLeaveBn} ‡¶ü‡¶ø, ‡¶Ö‡¶¨‡¶∂‡¶ø‡¶∑‡ßç‡¶ü ‡¶Ü‡¶õ‡ßá ${remainingLeaveBn} ‡¶ü‡¶ø ‡¶õ‡ßÅ‡¶ü‡¶ø‡•§</p>`;
      // --- ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶∂‡ßá‡¶∑ ---


      // ‡¶Ø‡¶¶‡¶ø ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶π‡¶Ø‡¶º ‡¶§‡¶¨‡ßá ‡¶∏‡ßá‡¶ü‡¶ø, ‡¶®‡¶æ ‡¶π‡¶≤‡ßá '‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§ ‡¶ì ‡¶™‡¶æ‡¶∞‡¶ø‡¶¨‡¶æ‡¶∞‡¶ø‡¶ï' ‡¶∂‡¶¨‡ßç‡¶¶‡¶ü‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá
      const displayReason = reason.trim() ? reason : '‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§ ‡¶ì ‡¶™‡¶æ‡¶∞‡¶ø‡¶¨‡¶æ‡¶∞‡¶ø‡¶ï';

      const preview = `
        <div id="printArea" style="font-size:14px; line-height:1.8; padding: 1px;">
        <p class="date-line">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ${new Date().toLocaleDateString('bn-BD')}</p>
        <p><strong>‡¶¨‡¶∞‡¶æ‡¶¨‡¶∞</strong><br>‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï,<br>${school}<br>${address}</p>
        <p><strong>‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º: ${days} ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶®‡ßà‡¶Æ‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶¨‡ßá‡¶¶‡¶®‡•§</p>
        <p>‡¶Æ‡¶æ‡¶®‡¶®‡ßÄ‡¶Ø‡¶º ‡¶Æ‡¶π‡ßã‡¶¶‡¶Ø‡¶º,<br>
        ‡¶¨‡¶ø‡¶®‡ßÄ‡¶§ ‡¶®‡¶ø‡¶¨‡ßá‡¶¶‡¶® ‡¶è‡¶á ‡¶Ø‡ßá, ‡¶Ü‡¶Æ‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º‡ßá‡¶∞ ‡¶è‡¶∞ ‡¶è‡¶ï‡¶ú‡¶® ${designation}‡•§ ${displayReason} ‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ${startDate} ‡¶π‡¶§‡ßá ${endDate} ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ (${days} ‡¶¶‡¶ø‡¶®) ‡¶®‡ßà‡¶Æ‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶õ‡ßÅ‡¶ü‡¶ø ‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§</p>
        <p>‡¶Ö‡¶§‡¶è‡¶¨, ‡¶Æ‡¶π‡ßã‡¶¶‡¶Ø‡¶º‡ßá‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶¨‡¶ø‡¶®‡ßÄ‡¶§ ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß, ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶â‡¶ï‡ßç‡¶§ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡¶∏‡¶Æ‡ßÇ‡¶π‡ßá ‡¶®‡ßà‡¶Æ‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶õ‡ßÅ‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡ßá ‡¶ú‡¶®‡¶æ‡¶¨‡ßá‡¶∞ ‡¶∏‡¶¶‡¶Ø‡¶º ‡¶Æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶π‡¶Ø‡¶º‡•§</p>
        
        <!-- ‡¶®‡¶§‡ßÅ‡¶® ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã -->
        ${leaveSummary}
        
        <br>
        <p style="margin-top: 30px;">‡¶¨‡¶ø‡¶®‡ßÄ‡¶§<br>
        ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞: __________________<br>
        ‡¶®‡¶æ‡¶Æ: ${name}<br>
        ‡¶™‡¶¶‡¶¨‡¶ø: ${designation}<br>
        ${school}<br>${address}‡•§
        </p>
        </div>
      `;

      document.getElementById('preview').innerHTML = preview;
      document.getElementById('printButtons').style.display = 'flex';
    }

    /* --- ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® --- */
    function printOnlyPreview() {
      const printContents = document.getElementById('printArea').outerHTML;
      const win = window.open('', '', 'height=800,width=600');
      
      win.document.write('<html><head><title>‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü</title>');
      // ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶â‡¶á‡¶®‡ßç‡¶°‡ßã‡¶§‡ßá ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶´‡¶®‡ßç‡¶ü ‡¶ì ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ
      win.document.write('<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;700&display=swap" rel="stylesheet">');
      win.document.write('<style>@page{margin:0.8in;} body{font-family: "Noto Sans Bengali", sans-serif; font-size:14px; line-height: 1.8;}</style>');
      win.document.write('</head><body>');
      win.document.write(printContents);
      win.document.write('</body></html>');
      
      win.document.close(); // DOM ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶≤‡ßã‡¶° ‡¶π‡¶ì‡ßü‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ
      win.focus(); // ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞
      
      // ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶π‡¶ì‡ßü‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡¶æ‡¶Æ‡¶æ‡¶®‡ßç‡¶Ø ‡¶¶‡ßá‡¶∞‡¶ø
      setTimeout(() => {
        win.print();
        win.close();
      }, 250);
    }

    /* --- PDF ‡¶∏‡ßá‡¶≠ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá) --- */
    
  </script>
</body>
</html>

